# Há»‡ Thá»‘ng Quáº£n LÃ½ TrÆ°á»ng Máº§m Non - EMIS (Educational Management Information System)

## ğŸ“‹ Tá»•ng Quan Dá»± Ãn

### Má»¥c tiÃªu
XÃ¢y dá»±ng há»‡ thá»‘ng quáº£n lÃ½ trÆ°á»ng máº§m non Ä‘a chá»©c nÄƒng, káº¿t ná»‘i giá»¯a nhÃ  trÆ°á»ng vÃ  phá»¥ huynh, há»— trá»£ multi-tenant cho Ä‘áº¿n 25,000 trÆ°á»ng há»c.

### Quy mÃ´
- **Sá»‘ lÆ°á»£ng trÆ°á»ng:** LÃªn Ä‘áº¿n 25,000 trÆ°á»ng (multi-tenant)
- **Má»—i trÆ°á»ng:**
  - ~30 giÃ¡o viÃªn
  - ~500 há»c sinh
  - ~1,000 phá»¥ huynh (má»—i há»c sinh cÃ³ Ã­t nháº¥t 2 phá»¥ huynh)
- **Tá»•ng Æ°á»›c tÃ­nh ngÆ°á»i dÃ¹ng:** ~38,250,000 users (25K trÆ°á»ng x 1,530 users/trÆ°á»ng)

### NgÆ°á»i dÃ¹ng & Vai trÃ²
- **Admin Há»‡ thá»‘ng:** Quáº£n lÃ½ toÃ n bá»™ há»‡ thá»‘ng, onboard trÆ°á»ng má»›i
- **Admin TrÆ°á»ng:** Quáº£n lÃ½ má»™t trÆ°á»ng cá»¥ thá»ƒ
- **GiÃ¡o viÃªn:** Quáº£n lÃ½ lá»›p há»c, há»c sinh, Ä‘Äƒng báº£ng tin, nháº­n xÃ©t
- **Phá»¥ huynh:** Xem thÃ´ng tin con, nháº­n thÃ´ng bÃ¡o, chat vá»›i giÃ¡o viÃªn
- **Quáº£n lÃ½ NhÃ¢n sá»±:** Quáº£n lÃ½ há»“ sÆ¡ nhÃ¢n viÃªn
- **Káº¿ toÃ¡n:** Quáº£n lÃ½ há»c phÃ­, thanh toÃ¡n

## ğŸ¯ Chá»©c NÄƒng ChÃ­nh

### 1. Quáº£n LÃ½ Há»c Sinh
- âœ… Há»“ sÆ¡ há»c sinh (há» tÃªn, giá»›i tÃ­nh, ngÃ y sinh, mÃ£ há»c sinh, dÃ¢n tá»™c, Ä‘á»‹a chá»‰)
- âœ… Tráº¡ng thÃ¡i há»c táº­p (Ä‘ang há»c, Ä‘Ã£ nghá»‰, báº£o lÆ°u, há»c thá»­)
- âœ… Quáº£n lÃ½ phá»¥ huynh
- âœ… Äiá»ƒm danh hÃ ng ngÃ y
- âœ… Nháº­n xÃ©t hÃ ng ngÃ y
- âœ… ÄÃ¡nh giÃ¡ theo tiÃªu chÃ­ (kÃ¨m hÃ¬nh áº£nh, video)
- âœ… Theo dÃµi sá»± phÃ¡t triá»ƒn

### 2. Quáº£n LÃ½ GiÃ¡o ViÃªn
- âœ… Há»“ sÆ¡ giÃ¡o viÃªn (há» tÃªn, ngÃ y sinh, giá»›i tÃ­nh, Ä‘á»‹a chá»‰, sá»‘ Ä‘iá»‡n thoáº¡i)
- âœ… Quáº£n lÃ½ vai trÃ²
- âœ… PhÃ¢n cÃ´ng lá»›p há»c
- âœ… Lá»‹ch dáº¡y

### 3. Báº£ng Tin (News Feed)
- âœ… ÄÄƒng bÃ i theo lá»›p (giÃ¡o viÃªn chá»§ nhiá»‡m)
- âœ… ÄÄƒng bÃ i toÃ n trÆ°á»ng (admin)
- âœ… ÄÃ­nh kÃ¨m hÃ¬nh áº£nh, video
- âœ… ThÃ´ng bÃ¡o kháº©n cáº¥p

### 4. Há»‡ Thá»‘ng Chat Real-time
- âœ… Chat 1-1 (phá»¥ huynh â†” giÃ¡o viÃªn)
- âœ… Chat nhÃ³m theo há»c sinh (phá»¥ huynh + giÃ¡o viÃªn + admin)
- âœ… Chat nhÃ³m lá»›p (táº¥t cáº£ phá»¥ huynh + giÃ¡o viÃªn lá»›p)
- âœ… Chat nhÃ³m riÃªng (custom group)
- âœ… LÆ°u trá»¯ lá»‹ch sá»­ chat lÃ¢u dÃ i
- âœ… ÄÃ­nh kÃ¨m áº£nh vÃ  file

### 5. Quáº£n LÃ½ Há»c PhÃ­
- âœ… TÃ­nh toÃ¡n há»c phÃ­
- âœ… Thanh toÃ¡n online
- âœ… Lá»‹ch sá»­ giao dá»‹ch
- âœ… Nháº¯c ná»£ tá»± Ä‘á»™ng

### 6. Quáº£n LÃ½ Thá»±c ÄÆ¡n
- âœ… Thá»±c Ä‘Æ¡n hÃ ng ngÃ y/tuáº§n
- âœ… ThÃ´ng tin dinh dÆ°á»¡ng
- âœ… ThÃ´ng bÃ¡o cho phá»¥ huynh

### 7. Quáº£n LÃ½ Nghá»‰ PhÃ©p
- âœ… Xin nghá»‰ (há»c sinh, giÃ¡o viÃªn)
- âœ… PhÃª duyá»‡t nghá»‰ phÃ©p
- âœ… Lá»‹ch sá»­ nghá»‰ phÃ©p

### 8. BÃ¡o CÃ¡o & Thá»‘ng KÃª
- âœ… BÃ¡o cÃ¡o Ä‘iá»ƒm danh
- âœ… BÃ¡o cÃ¡o há»c phÃ­
- âœ… BÃ¡o cÃ¡o sá»± phÃ¡t triá»ƒn há»c sinh
- âœ… BÃ¡o cÃ¡o nhÃ¢n sá»±
- âœ… Dashboard quáº£n lÃ½

### 9. Camera GiÃ¡m SÃ¡t
- âœ… Streaming trá»±c tiáº¿p
- âœ… Xem láº¡i recording
- âœ… PhÃ¢n quyá»n xem camera

## ğŸ—ï¸ Kiáº¿n TrÃºc Tá»•ng Quan

### Kiáº¿n TrÃºc Microservices + Clean Architecture + DDD

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        API GATEWAY (YARP)                        â”‚
â”‚                  + Authentication & Authorization                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Identity   â”‚ â”‚   Student    â”‚ â”‚   Teacher    â”‚
â”‚   Service    â”‚ â”‚   Service    â”‚ â”‚   Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        
        â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Attendance   â”‚ â”‚   News Feed  â”‚ â”‚     Chat     â”‚
â”‚   Service    â”‚ â”‚   Service    â”‚ â”‚   Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Payment    â”‚ â”‚     Menu     â”‚ â”‚    Leave     â”‚
â”‚   Service    â”‚ â”‚   Service    â”‚ â”‚   Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Camera     â”‚ â”‚   Report     â”‚ â”‚ Notification â”‚
â”‚   Service    â”‚ â”‚   Service    â”‚ â”‚   Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Message Bus (Event-Driven Architecture)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            RabbitMQ / Apache Kafka (Event Bus)                   â”‚
â”‚  - Domain Events                                                 â”‚
â”‚  - Integration Events                                            â”‚
â”‚  - Asynchronous Communication between Services                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Storage Strategy
- **MySQL:** Transactional data (Student, Teacher, Attendance, Payment...)
- **MongoDB:** Chat history, Logs, Documents
- **Redis:** Cache, Session, Real-time data
- **MinIO/S3:** File storage (Images, Videos, Documents)

### Real-time Communication
- **SignalR:** Real-time notifications, Chat
- **WebRTC:** Camera streaming

## ğŸ¨ Clean Architecture Layers (Má»—i Microservice)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API / Presentation                    â”‚
â”‚  - REST API Controllers                                  â”‚
â”‚  - gRPC Services                                         â”‚
â”‚  - SignalR Hubs                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Application Layer                      â”‚
â”‚  - Use Cases / Commands / Queries (CQRS)                â”‚
â”‚  - DTOs / View Models                                    â”‚
â”‚  - Application Services                                  â”‚
â”‚  - Validators (FluentValidation)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Domain Layer (DDD)                    â”‚
â”‚  - Entities / Aggregates                                 â”‚
â”‚  - Value Objects                                         â”‚
â”‚  - Domain Events                                         â”‚
â”‚  - Domain Services                                       â”‚
â”‚  - Repository Interfaces                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Infrastructure Layer                     â”‚
â”‚  - Repository Implementations                            â”‚
â”‚  - EF Core / Dapper                                      â”‚
â”‚  - External Services Integration                         â”‚
â”‚  - Message Bus Implementation                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Multi-Tenancy Strategy

### Hybrid Approach: Database per Tenant (cho data isolation) + Shared Infrastructure

#### Tenant Identification
- **TenantId** trong má»i request (tá»« JWT token hoáº·c subdomain)
- Middleware Ä‘á»ƒ extract vÃ  validate TenantId
- Global Query Filter trong EF Core Ä‘á»ƒ auto-filter theo TenantId

#### Database Strategy
- **Shared Database + TenantId Column:** Cho metadata, configuration
- **Database per Tenant (Optional):** Cho trÆ°á»ng cÃ³ yÃªu cáº§u data isolation cao
- **Connection String Resolver:** Dynamic connection string dá»±a trÃªn TenantId

#### Example:
```
tenant1.emis.com â†’ TenantId: "tenant1" â†’ Database: emis_tenant1
tenant2.emis.com â†’ TenantId: "tenant2" â†’ Database: emis_tenant2
```

## ğŸ”’ Security & Authentication

### Identity Service (IdentityServer hoáº·c Keycloak)
- **Multi-tenant Authentication**
- **Role-based Access Control (RBAC)**
- **Permission-based Authorization**
- **JWT Token vá»›i Claims:**
  - TenantId
  - UserId
  - Roles
  - Permissions

### Security Features
- âœ… Password hashing (BCrypt/Argon2)
- âœ… JWT Token vá»›i refresh token
- âœ… Rate limiting
- âœ… API Key cho mobile app
- âœ… CORS configuration
- âœ… Data encryption at rest
- âœ… HTTPS/TLS

## ğŸ“± Client Applications

### Mobile App (Flutter)
- **Phá»¥ huynh:** Xem thÃ´ng tin con, chat, nháº­n thÃ´ng bÃ¡o, xem camera
- **GiÃ¡o viÃªn:** Äiá»ƒm danh, nháº­n xÃ©t, Ä‘Äƒng báº£ng tin, chat

### Web Application (Blazor Server / React / Angular)
- **Admin:** Quáº£n lÃ½ toÃ n bá»™ há»‡ thá»‘ng
- **GiÃ¡o viÃªn:** Táº¥t cáº£ chá»©c nÄƒng quáº£n lÃ½
- **Káº¿ toÃ¡n:** Quáº£n lÃ½ há»c phÃ­
- **HR:** Quáº£n lÃ½ nhÃ¢n sá»±

## ğŸ“Š Non-Functional Requirements

### Performance
- **Response Time:** < 500ms (p95)
- **Throughput:** 10,000 requests/second
- **Concurrent Users:** 100,000+

### Scalability
- **Horizontal Scaling:** Kubernetes auto-scaling
- **Database Sharding:** Khi cáº§n thiáº¿t
- **CDN:** Cho static assets

### Availability
- **Uptime:** 99.9% (SLA)
- **Database Replication:** Master-Slave
- **Backup:** Daily automated backup

### Monitoring & Observability
- **Logging:** Serilog + ELK Stack (Elasticsearch, Logstash, Kibana)
- **Metrics:** Prometheus + Grafana
- **Tracing:** Jaeger / OpenTelemetry
- **Health Checks:** ASP.NET Core Health Checks

## ğŸš€ Deployment

### Kubernetes on-premise
- **Container Orchestration:** Kubernetes
- **Container Registry:** Harbor / Private Docker Registry
- **CI/CD:** GitLab CI / GitHub Actions
- **Infrastructure as Code:** Terraform / Helm Charts

### Environment
- **Development:** Local Docker Compose
- **Staging:** K8s Staging Cluster
- **Production:** K8s Production Cluster (HA setup)

## ğŸ“ˆ PhÃ¡t Triá»ƒn Theo Giai Äoáº¡n

### Phase 1: MVP (3-4 months)
- âœ… Identity Service
- âœ… Student Service (cÆ¡ báº£n)
- âœ… Teacher Service (cÆ¡ báº£n)
- âœ… Attendance Service
- âœ… News Feed Service
- âœ… Notification Service
- âœ… Mobile App (basic features)
- âœ… Web Admin (basic features)

### Phase 2: Core Features (2-3 months)
- âœ… Chat Service (real-time)
- âœ… Payment Service
- âœ… Menu Service
- âœ… Leave Service
- âœ… Report Service (basic)

### Phase 3: Advanced Features (2-3 months)
- âœ… Camera Service
- âœ… Advanced Reporting & Analytics
- âœ… AI-powered features (Recommendations, Auto-grading)
- âœ… Performance optimization

### Phase 4: Scale & Optimize (Ongoing)
- âœ… Load testing & optimization
- âœ… Multi-region deployment
- âœ… Advanced monitoring
- âœ… Cost optimization

---

## ğŸ“š TÃ i Liá»‡u LiÃªn Quan

- [02-Microservices-Design.md](./02-Microservices-Design.md) - Chi tiáº¿t tá»«ng microservice
- [03-Domain-Models.md](./03-Domain-Models.md) - Domain models & Database schema
- [04-API-Contracts.md](./04-API-Contracts.md) - API endpoints & contracts
- [05-Technology-Stack.md](./05-Technology-Stack.md) - CÃ´ng nghá»‡ & thÆ° viá»‡n
- [06-Deployment-Architecture.md](./06-Deployment-Architecture.md) - Kiáº¿n trÃºc triá»ƒn khai

---

**Version:** 1.0  
**Last Updated:** November 5, 2025  
**Author:** EMIS Architecture Team
